<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin SMK Bina Mandiri</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; margin: 0; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; border-bottom: 5px solid #ccc; }
        .card h3 { margin: 0; font-size: 14px; color: #666; }
        .card h2 { margin: 10px 0 0 0; font-size: 32px; }

        /* Warna Border sesuai Dashboard kamu */
        .hadir { border-color: #2ecc71; }
        .terlambat { border-color: #e74c3c; }
        .izin { border-color: #3498db; }
        .alpa { border-color: #2c3e50; background: #2c3e50; color: white; }
        .alpa h3 { color: #eee; }

        .btn-refresh { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <h1>ADMIN SMK BM</h1>
        <button class="btn-refresh" onclick="updateDashboard()">Refresh Data</button>
    </div>

    <div class="stats-grid">
        <div class="card hadir">
            <h3>HADIR</h3>
            <h2 id="count-hadir">0</h2>
        </div>
        <div class="card terlambat">
            <h3>TERLAMBAT</h3>
            <h2 id="count-terlambat">0</h2>
        </div>
        <div class="card izin">
            <h3>IZIN/SAKIT</h3>
            <h2 id="count-izin">0</h2>
        </div>
        <div class="card alpa">
            <h3>TANPA KET</h3>
            <h2 id="count-alpa">0</h2>
        </div>
    </div>

    <script>
        // Fungsi untuk mengambil data dari API Vercel
        async function updateDashboard() {
            try {
                // Menghubungkan ke endpoint API yang telah kita buat di folder /api/data.js
                const response = await fetch('/api/data');
                const data = await response.json();

                // Memasukkan data ke elemen HTML
                document.getElementById('count-hadir').innerText = data.hadir;
                document.getElementById('count-terlambat').innerText = data.terlambat;
                document.getElementById('count-izin').innerText = data.izin;
                document.getElementById('count-alpa').innerText = data.alpa;

                console.log("Sync Berhasil:", data.waktuUpdate);
            } catch (error) {
                console.error("Gagal mengambil data dari API:", error);
            }
        }

        // Panggil fungsi saat halaman pertama kali dibuka
        window.onload = updateDashboard;

        // Auto refresh setiap 1 menit agar data antar admin tetap sama
        setInterval(updateDashboard, 60000);
    </script>
</body>
</html>